# 📦 Умный склад (Smart Warehouse)

Система управления складской логистикой с использованием автономных роботов для Ростелекома.

## 🚀 Быстрый старт

### Предварительные требования
- Docker и Docker Compose
- Git

### Запуск приложения

1. **Клонирование репозитория**
```bash
git clone <repository-url>
cd smart-storage
```

2. **Запуск всех сервисов**
```bash
docker-compose up --build
```

3. **Доступ к приложению**
- Frontend: http://localhost:80
- Backend API: http://localhost:3000
- API документация: http://localhost:3000/docs

### Тестовые учетные данные
- **Email:** admin@rostelecom.ru
- **Пароль:** password123

## 🏗️ Архитектура

### Компоненты системы
- **Frontend** (React + Tailwind CSS) - Веб-интерфейс
- **Backend** (FastAPI + SQLAlchemy) - REST API и WebSocket
- **Database** (PostgreSQL) - Хранение данных
- **Redis** - Кеширование и WebSocket
- **Robot Emulator** (Python) - Эмуляция роботов для тестирования

### Структура проекта
```
smart-storage/
├── frontend/                 # React приложение
│   ├── src/
│   │   ├── components/      # React компоненты
│   │   └── App.jsx         # Главный компонент
│   ├── Dockerfile
│   └── package.json
├── backend/                 # FastAPI сервер
│   ├── main.py             # Основной файл API
│   ├── requirements.txt
│   └── Dockerfile
├── database/
│   └── init.sql            # Инициализация БД
├── robot-emulator/         # Эмулятор роботов
│   ├── emulator.py
│   ├── requirements.txt
│   └── Dockerfile
├── docker-compose          # Конфигурация Docker
└── README.md
```

## 📱 Функциональность

### 1. Авторизация (/login)
- Вход в систему с JWT токенами
- Валидация email и пароля
- Сохранение сессии

### 2. Мониторинг в реальном времени (/dashboard)
- **Карта склада** - Интерактивная SVG карта с позициями роботов
- **Статистика** - Активные роботы, проверенные товары, критические остатки
- **Последние сканирования** - Таблица с обновлениями каждые 5 секунд
- **ИИ прогнозы** - Предиктивная аналитика остатков на 7 дней
- **WebSocket** - Real-time обновления

### 3. Исторические данные (/history)
- **Фильтры** - По дате, зонам, статусу, поиск
- **Таблица данных** - Сортировка, пагинация, выбор записей
- **Экспорт** - В Excel и PDF форматы
- **Статистика** - Сводные показатели за период

### 4. Загрузка CSV
- Drag & Drop интерфейс
- Валидация формата файла
- Предпросмотр данных
- Обработка ошибок

## 🔌 API Endpoints

### Авторизация
- `POST /api/auth/login` - Вход в систему

### Роботы
- `POST /api/robots/data` - Прием данных от роботов
- `WS /api/ws/dashboard` - WebSocket для real-time обновлений

### Данные
- `GET /api/dashboard/current` - Текущее состояние системы
- `GET /api/inventory/history` - Исторические данные
- `POST /api/inventory/import` - Загрузка CSV
- `GET /api/export/excel` - Экспорт данных

### ИИ
- `POST /api/ai/predict` - Получение прогнозов

## 🤖 Эмулятор роботов

Эмулятор автоматически отправляет данные от 5 роботов каждые 10 секунд:
- Перемещение по зонам A-E
- Сканирование товаров
- Отправка данных о батарее и местоположении
- Симуляция различных статусов (активен, низкий заряд, офлайн)

## 🗄️ База данных

### Основные таблицы
- `users` - Пользователи системы
- `robots` - Информация о роботах
- `products` - Каталог товаров
- `inventory_history` - История инвентаризации
- `ai_predictions` - Прогнозы ИИ

### Тестовые данные
При первом запуске автоматически создаются:
- Тестовые пользователи
- 5 товаров Ростелекома
- 5 роботов с различными статусами

## 📊 Формат CSV

Для загрузки данных используйте CSV файл с разделителем ";":

```csv
product_id;product_name;quantity;zone;date;row;shelf;category
TEL-4567;Роутер RT-AC68U;45;A;2024-03-15;12;3;Сетевое оборудование
```

**Обязательные поля:** product_id, product_name, quantity, zone, date

## 🛠️ Разработка

### Локальная разработка

1. **Backend**
```bash
cd backend
pip install -r requirements.txt
uvicorn main:app --reload
```

2. **Frontend**
```bash
cd frontend
npm install
npm start
```

3. **База данных**
```bash
docker run -d -p 5432:5432 -e POSTGRES_DB=warehouse_db -e POSTGRES_USER=warehouse_user -e POSTGRES_PASSWORD=secure_password postgres:15
```

### Переменные окружения

**Backend:**
- `DATABASE_URL` - URL подключения к PostgreSQL
- `JWT_SECRET` - Секретный ключ для JWT
- `AI_API_KEY` - API ключ для ИИ сервиса

**Frontend:**
- `REACT_APP_API_URL` - URL backend API
- `REACT_APP_WS_URL` - URL WebSocket

## 🧪 Тестирование

### Тестовые сценарии

1. **Авторизация**
   - Вход с корректными данными
   - Валидация email и пароля
   - Сохранение токена

2. **Мониторинг**
   - Отображение карты склада
   - Обновление статистики
   - WebSocket соединение

3. **История**
   - Фильтрация данных
   - Экспорт в Excel
   - Пагинация

4. **CSV загрузка**
   - Валидация формата
   - Обработка ошибок
   - Импорт данных

## 📈 Производительность

- **Время загрузки страниц:** < 2 секунд
- **WebSocket обновления:** каждые 5 секунд
- **Эмулятор роботов:** каждые 10 секунд
- **База данных:** оптимизированные индексы

## 🔒 Безопасность

- JWT токены для авторизации
- Хеширование паролей (bcrypt)
- CORS настройки
- Валидация входных данных
- SQL injection защита (SQLAlchemy ORM)

## 📝 Логирование

Все сервисы логируют:
- Ошибки и исключения
- WebSocket соединения
- API запросы
- Действия роботов

## 🚀 Развертывание в продакшене

1. **Изменение паролей и секретов**
2. **Настройка SSL сертификатов**
3. **Конфигурация reverse proxy**
4. **Мониторинг и логирование**
5. **Резервное копирование БД**

## 📞 Поддержка

При возникновении проблем:
1. Проверьте логи Docker контейнеров
2. Убедитесь в доступности всех портов
3. Проверьте подключение к базе данных
4. Обратитесь к документации API: http://localhost:3000/docs

---
